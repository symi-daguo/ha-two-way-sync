# 更新日志

所有重要的项目更改都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [2.1.3] - 2025-09-03

### 修复
- 🐛 **集成无法添加**: 修复集成无法在Home Assistant中正常添加的关键问题
- 📁 **缺失文件**: 补充缺失的services.yaml、strings.json和translations文件
- 🔧 **配置完整性**: 修复manifest.json配置不完整导致的加载失败
- 🌐 **多语言支持**: 恢复完整的中英文界面支持

### 改进
- 🛡️ **稳定性增强**: 进一步优化错误处理和重试机制
- 📝 **文档更新**: 更新版本信息和发布日期
- 🏗️ **项目结构**: 优化项目文件结构，确保完整性

### 技术改进
- 📦 **版本统一**: 统一所有文件的版本号到 v2.1.3
- 🔄 **配置恢复**: 从备份版本恢复完整的配置文件
- 📋 **服务定义**: 恢复完整的服务定义和界面文本

## [2.1.2] - 2025-01-21

### 新增
- 🔄 **集成重新加载支持**: 新增 `reload` 服务，无需重启 Home Assistant 即可重新加载集成
- 🛠️ **增强错误恢复机制**: 实现自动重连和异常处理，确保系统高可用性
- 📊 **详细日志记录**: 增强调试信息和性能监控，便于问题诊断
- 🔍 **同步历史追踪**: 记录最近10次同步操作的详细信息
- ⚡ **性能统计**: 实时监控同步性能和成功率

### 改进
- 🔧 **生命周期管理**: 优化集成加载和卸载过程，确保配置持久化
- 🛡️ **健康检查**: 增强实体状态监控和自动恢复机制
- 🔄 **后台恢复**: 改进后台恢复任务，处理网络中断、设备重启等突发情况
- 📝 **日志前缀**: 为所有日志添加统一前缀，便于识别和过滤
- ⏱️ **性能监控**: 添加同步耗时统计和性能警告

### 修复
- 🐛 **集成加载失败**: 修复更新后集成条目显示"未加载"的问题
- 🔌 **服务注册**: 修复服务注册问题，确保所有服务正常可用
- 🔄 **重试机制**: 增加设置失败后的重试逻辑，提高成功率
- 💾 **内存管理**: 优化性能数据存储，避免内存泄漏

### 技术改进
- 📦 **版本管理**: 统一所有文件的版本号到 v2.1.2
- 🏗️ **代码结构**: 重构服务注册逻辑，提高代码可维护性
- 🧪 **错误处理**: 增强异常捕获和错误恢复能力
- 📈 **监控指标**: 添加实体可用性和同步成功率监控

## [2.1.1] - 2025-01-03

### 新增
- ✨ **完善的双向同步**: 开关、调光、窗帘双向同步功能全面稳定
- 🐕 **增强的看门狗机制**: 重启恢复机制，确保系统稳定性
- 🔍 **优化的状态检查**: 实体状态检查和健康监控
- 🔄 **稳定的自动恢复**: 后台自动恢复功能

### 改进
- 🛡️ **防循环机制**: 内置防循环同步机制，确保系统稳定
- 🎯 **智能同步**: 相同类型实体支持完美同步，不同类型实体支持基础同步
- 📱 **广泛支持**: 支持多种设备类型的同步

### 修复
- 🐛 **同步稳定性**: 修复各种同步异常和状态不一致问题
- 🔧 **配置管理**: 改进配置流程和错误处理

## [2.1.0] - 2024-12-15

### 新增
- 🎉 **首个稳定版本**: 基础双向同步功能
- 🔄 **实时同步**: 支持两个实体之间的实时双向状态同步
- 🎛️ **服务支持**: 提供手动同步和切换同步状态的服务
- 🔧 **UI配置**: 通过 Home Assistant UI 界面轻松配置

### 支持的设备类型
- 💡 **灯光** (`light`): 完美同步 - 状态、亮度、颜色等
- 🔌 **开关** (`switch`): 完美同步 - 开关状态
- 🪟 **窗帘** (`cover`): 完美同步 - 开关状态和位置
- 🌀 **风扇** (`fan`): 完美同步 - 状态、速度等
- ❄️ **空调** (`climate`): 完美同步 - 温度、模式等
- 💧 **加湿器** (`humidifier`): 完美同步 - 状态、湿度等
- 🔥 **热水器** (`water_heater`): 完美同步 - 状态、温度等
- 🤖 **扫地机** (`vacuum`): 完美同步 - 状态、模式等
- 🎵 **媒体播放器** (`media_player`): 完美同步 - 播放状态、音量等
- 🎬 **场景** (`scene`): 完美同步 - 触发场景
- 📜 **脚本** (`script`): 完美同步 - 执行脚本
- 🔄 **自动化** (`automation`): 基础同步 - 开关状态
- ✅ **输入布尔** (`input_boolean`): 完美同步 - 开关状态
- 📋 **输入选择** (`input_select`): 完美同步 - 选项值
- 🔢 **输入数字** (`input_number`): 完美同步 - 数值
- 📝 **输入文本** (`input_text`): 完美同步 - 文本内容
- 🔒 **锁** (`lock`): 基础同步 - 开关状态

---

## 版本说明

- **[主版本]**: 不兼容的 API 修改
- **[次版本]**: 向下兼容的功能性新增
- **[修订版本]**: 向下兼容的问题修正

## 链接

- [GitHub Releases](https://github.com/symi-daguo/ha-two-way-sync/releases)
- [问题反馈](https://github.com/symi-daguo/ha-two-way-sync/issues)
- [贡献指南](https://github.com/symi-daguo/ha-two-way-sync/blob/main/README.md#🤝-贡献)